# Rice Classifier: Классификация сортов риса

Это проект по классификации пяти различных сортов риса: **Arborio**, **Basmati**, **Ipsala**, **Jasmine** и **Karacadag**. Проект включает в себя обучение нейронной сети, оценку её производительности и создание Telegram-бота для интерактивной демонстрации модели.

-----

## Основные возможности

  * **Классификация изображений**: Обученная модель способна определять сорт риса на основе его изображения.
  * **Оценка производительности**: Скрипты для тестирования модели и визуализации метрик, таких как матрица ошибок и точность по классам.
  * **Интерактивный Telegram-бот**: Бот, который позволяет пользователям угадывать сорт риса по фотографии и собирает данные для анализа человеческой производительности.
  * **Подготовка данных**: Скрипт для автоматического разделения исходного датасета на обучающую, валидационную и тестовую выборки.

-----

## Структура проекта

```
Rice_Classifier
├── human/                       # Файлы, относящиеся к Telegram-боту и анализу результатов
│   ├── bot_img/                 # Справочные изображения для бота
│   ├── results/                 # Результаты игр пользователей (генерируется bot.py)
│   ├── bot.py                   # Код Telegram-бота
│   └── test_human.py            # Скрипт для анализа производительности пользователей
├── src/                         # Исходный код для обучения и тестирования модели
│   ├── checkpoints/             # Сохраненные веса модели (генерируется train.py)
│   ├── Rice_Split/              # Разделенный датасет (генерируется split.py)
│   ├── dataset.py               # Класс для загрузки датасета
│   ├── model.py                 # Архитектура нейронной сети
│   ├── test.py                  # Скрипт для тестирования модели
│   ├── train.py                 # Скрипт для обучения модели
│   ├── vis.py                   # Скрипт для визуализации результатов модели
│   └── split.py                 # Скрипт для разделения датасета
├── LICENSE                      # Лицензия проекта
└── README.md                    # Этот файл
```

-----

## Установка и запуск

### Шаг 1: Клонирование репозитория

```bash
git clone https://github.com/LevOssadtchi-CV/rice-classifier.git
cd rice-classifier
```

### Шаг 2: Установка зависимостей

```bash
pip install -r requirements.txt
```

*Примечание: Если файла `requirements.txt` нет, его можно создать, перечислив используемые библиотеки:*

```bash
torch
torchvision
numpy
scikit-learn
matplotlib
python-telegram-bot
tqdm
```

### Шаг 3: Подготовка данных

1.  Скачайте датасет "Rice Image Dataset" с [Kaggle](https://www.kaggle.com/datasets/muratkokludataset/rice-image-dataset).

2.  Распакуйте его в корневую папку проекта так, чтобы путь к изображениям был `Rice_Image_Dataset/Arborio/...`, `Rice_Image_Dataset/Basmati/...` и т.д.

3.  Запустите скрипт для разделения данных:

    ```bash
    python split.py
    ```

    Это создаст папку `Rice_Split` с подпапками `train`, `val` и `test`.

### Шаг 4: Обучение модели

Для обучения модели классификации запустите скрипт `train.py`. Он будет сохранять веса модели в папку `checkpoints`.

```bash
python train.py
```

-----

## Оценка и визуализация

После обучения модели вы можете оценить её производительность на тестовой выборке и визуализировать результаты.

### Тестирование модели

Запустите `test.py` для вычисления общей точности и матрицы ошибок на тестовых данных:

```bash
python test.py
```

### Визуализация результатов

Используйте `vis.py` для создания графиков, таких как матрица ошибок, точность по классам и распределение уверенности модели.

```bash
python vis.py
```

-----

## Запуск Telegram-бота

Чтобы запустить бота, вам потребуется токен Telegram Bot API.

1.  Создайте нового бота через `@BotFather` в Telegram и получите его токен.

2.  Вставьте ваш токен в файл `bot.py` вместо заглушки: `TOKEN = "YOUR_TELEGRAM_BOT_TOKEN"`.

3.  Установите библиотеку `pyTelegramBotAPI`

    ```bash
    pip install pyTelegramBotAPI
    ```

4.  Создайте папку `bot_img` и поместите в нее одну референсную картинку для каждого сорта, например `Arborio.jpg`, `Basmati.jpg` и т.д.

5.  Запустите бота:

    ```bash
    python bot.py
    ```

Бот будет доступен по вашему токену и позволит пользователям пройти тест на знание сортов риса. Результаты каждой игры будут сохраняться в папке `results`.

-----

## Вклад

Если у вас есть идеи по улучшению проекта, не стесняйтесь открывать issue или отправлять pull request.
